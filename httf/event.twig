{% extends 'partials/_master.twig' %}

{% block main %}

    {% set session = record.related('sessions')|first %}
    {% set eventtype = record|taxonomy.types|first %}

{% if app.request.get('preview') == "true" %}
    {% set showcontent = true %}
    {% set linktrailer = "?preview=true" %}
{% elseif eventtype != "Theme-setting paper"  %}
    {% setcontent programme_record = 'page/programme' %}
    {% if programme_record.redirect is not empty %}
    {% include 'redirect.twig' with {'record': programme_record} %}
    {% else %}
    {% set showcontent = true %}
    {% endif %}
{% else %}
    {% set showcontent = true %}
{% endif %}
{% if showcontent %}

    <div class="breadcrumb-container col-12">
        <nav aria-label="breadcrumb" class="shadow rounded">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">{{ config.get('general/sitename') -}}</a></li>
                <li class="breadcrumb-item"><a href="/programme{{ linktrailer }}">Programme</a></li>
                <li class="breadcrumb-item"><a href="{{ path('contentlink', {contenttypeslug: 'sessions', slug: session.slug}) }}{{ linktrailer }}">{{ session.title }}</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ eventtype }}</li>
            </ol>
        </nav>
    </div>

    <div class="col-xl-9 col-lg-8 col-md-7 col-12">
        <div class="jumbotron p-3 m-0 mb-3 rounded shadow">
            <h1>{{ record.title }}</h1>
            {{ record.authors|markdown }}
        </div>
        <article>
            <div>
                {{ record.teaser|markdown }}

                {% if record.pdffile is not empty %}
                <p><a href="{{ asset(record.pdffile, "files") }}" title="Read '{{ record.title }}'">Download a copy of this paper</a></p>
                {% elseif record.pdflink is not empty %}
                <p><a href="{{ record.pdflink }}" title="Read '{{ record.title }}'">Download a copy of this paper</a></p>
                {% endif %}
            </div>
        </article>
    </div>
    <aside class="col-xl-3 col-lg-4 col-md-5 col-12">
        {% set starttime = session.starttime ? session.starttime|date_modify("+" ~ (record.sessionoffset) ~ " mins")|date('H:i') : '' %}
        {% if starttime is not empty and eventtype != "Theme-setting paper" %}
        <div class="card shadow shadow-darker rounded" class="p-2">
          <div class="card-body">
            {% if session.location %}
            <div class="media event-details">
                <i class="fas fa-location-circle mr-2 event-details-icon" title="Location of the {{ sessiontype|lower }}" aria-label="Location of the {{ sessiontype|lower }}"></i>
                <div class="media-body">{% if session.locationlink %}<a href="{{ session.locationlink }}" title="About {{ session.location }}">{{ session.location }}</a>{% else %}{{ session.location }}{% endif %}</div>
            </div>
            <hr>
            {% endif %}
            <div class="media event-details mb-3">
                <i class="fas fa-calendar-day mr-2 event-details-icon" title="Date of the {{ eventtype|lower }}"aria-label="Date of the {{ eventtype|lower }}"></i>
                <div class="media-body"><strong>{{ session.starttime|date('jS F') }}</strong></div>
            </div>
            <div class="media event-details mb-3">
                <i class="fas fa-clock mr-2 event-details-icon" title="{% if record.sessionoffset > 0 %}Approximate{% else %}Scheduled{% endif %} start time of the {{ eventtype|lower }}" aria-label="{% if record.sessionoffset > 0 %}Approximate{% else %}Scheduled{% endif %} start time of the {{ eventtype|lower }}"></i>
                <div class="media-body"><strong>{{ starttime|date('H:i') }}</strong>{% if record.sessionoffset > 0 %} approx.{% endif %}</div>
            </div>
            <div class="media event-details mb-0">
                <i class="fas fa-hourglass-end mr-2 event-details-icon" title="Length of the {{ eventtype|lower }}" aria-label="Length of the {{ eventtype|lower }}"></i>
                <div class="media-body"><strong>{{ record.lengthmins }}</strong> minutes</div>
            </div>
          </div>
        </div>
        {% endif %}
        {% if record.citation is not empty %}
        <div class="card shadow rounded" class="p-2">
          <div class="card-body">
            <h5 class="card-title">Reference</h5>
            <p class="card-text">
                {{ record.citation|markdown }}
            </p>
          </div>
        </div>
        {% endif %}
    </aside>

{% endif    %}
{% endblock main %}
